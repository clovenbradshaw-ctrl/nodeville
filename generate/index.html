<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QR Code Generator - NODEVILLE</title>
  <meta name="description" content="Generate Meshtastic channel configuration QR codes.">
  <meta name="theme-color" content="#E85D04">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>â—‰</text></svg>">
  <link rel="stylesheet" href="/css/style.css">
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1/build/qrcode.min.js"></script>
</head>
<body>

  <main class="container">
    <a href="/" class="back-link">â† Back to home</a>

    <div class="page-header">
      <span class="icon">âš™ï¸</span>
      <h1>QR Code Generator</h1>
      <p class="subtitle">Create channel configurations without a device</p>
    </div>

    <div data-tabs>
      <div class="tabs">
        <button class="tab active">Network QR</button>
        <button class="tab">Private Channel</button>
      </div>

      <!-- Tab 1: Network QR -->
      <div class="tab-content active">
        <p>
          This generates the standard Nodeville network configuration.
          Share this with new users to get them on the mesh.
        </p>

        <div class="qr-wrapper">
          <div class="qr-container">
            <canvas id="network-qr-gen" data-qr="network" data-size="256"></canvas>
          </div>
        </div>

        <div class="copy-group">
          <code id="network-url-gen" data-network-url>Loading...</code>
          <button class="copy-btn" data-copy-target="network-url-gen">ğŸ“‹ Copy</button>
        </div>

        <h3>Settings included:</h3>
        <div class="config-display">
          <div class="config-item">
            <span class="config-key">Region</span>
            <span class="config-value">US</span>
          </div>
          <div class="config-item">
            <span class="config-key">Preset</span>
            <span class="config-value">MEDIUM_FAST</span>
          </div>
          <div class="config-item">
            <span class="config-key">Hop Limit</span>
            <span class="config-value">7</span>
          </div>
          <div class="config-item">
            <span class="config-key">Channel</span>
            <span class="config-value">Public Nashville mesh</span>
          </div>
          <div class="config-item">
            <span class="config-key">OK to MQTT</span>
            <span class="config-value">Enabled</span>
          </div>
        </div>
      </div>

      <!-- Tab 2: Private Channel -->
      <div class="tab-content">
        <p>
          Create an encrypted channel to share with specific people.
        </p>

        <form id="private-channel-form">
          <div class="form-group">
            <label class="form-label" for="channel-name">Channel Name</label>
            <input type="text" id="channel-name" class="form-input"
                   placeholder="e.g., Family, Work, Alex" maxlength="12">
          </div>

          <div class="form-group">
            <label class="form-label">Encryption</label>
            <div class="form-radio-group">
              <label class="form-radio">
                <input type="radio" name="encryption" value="random" checked>
                AES-256 (Random)
              </label>
              <label class="form-radio">
                <input type="radio" name="encryption" value="custom">
                Custom Key
              </label>
            </div>
          </div>

          <button type="submit" class="btn btn-primary btn-full">
            Generate Private Channel QR
          </button>
        </form>

        <div id="private-result" style="display: none; margin-top: 2rem;">
          <div class="alert alert-warning">
            <span class="alert-icon">âš ï¸</span>
            <div class="alert-content">
              <p><strong>Save this QR â€” you can't regenerate the same key!</strong></p>
            </div>
          </div>

          <div class="qr-wrapper">
            <div class="qr-container">
              <canvas id="private-qr"></canvas>
            </div>
          </div>

          <div class="copy-group">
            <code id="private-url">...</code>
            <button class="copy-btn" data-copy-target="private-url">ğŸ“‹ Copy</button>
          </div>

          <p style="text-align: center; color: var(--color-text-muted); margin-top: 1rem;">
            Share this QR only with people you want in this conversation.
          </p>
        </div>
      </div>
    </div>

    <div class="divider"><span class="node">â—‰</span></div>

    <div class="info-box">
      <div class="info-box-header">
        <span class="info-box-title">ğŸ”’ Security note</span>
        <span class="info-box-toggle">â–¼</span>
      </div>
      <div class="info-box-content">
        <p>
          When you generate a private channel QR code, a cryptographically random
          256-bit key is created. This key is encoded in the QR code itself.
        </p>
        <p>
          <strong>There's no backup.</strong> If you lose the QR code and don't have
          any devices with the channel saved, the key is gone forever. This is a
          feature, not a bug â€” it means there's no central authority that can recover
          or compromise your encryption.
        </p>
      </div>
    </div>

  </main>

  <footer class="site-footer">
    <p class="footer-text">
      â—‰â”€â”€â”€â—‰â”€â”€â”€â—‰â”€â”€â”€â—‰ Messages find a way.
    </p>
  </footer>

  <script src="/js/qr-generator.js"></script>
  <script src="/js/main.js"></script>
</body>
</html>
