<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Setup Guide - Nodeville</title>
  <meta name="description" content="Join Nashville's mesh network in about 10 minutes. Step-by-step setup guide for Meshtastic devices.">
  <meta name="theme-color" content="#E85D04">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>â—‰</text></svg>">
  <link rel="stylesheet" href="/css/style.css">
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1/build/qrcode.min.js"></script>
  <style>
    /* Setup guide specific styles */
    .setup-header {
      text-align: center;
      padding: var(--space-xl) 0 var(--space-2xl);
    }

    .setup-header__icon {
      font-size: 3.5rem;
      margin-bottom: var(--space-md);
    }

    .setup-header__title {
      font-family: var(--font-display);
      font-size: 2.5rem;
      font-weight: 600;
      text-transform: uppercase;
      color: var(--color-text);
      margin-bottom: var(--space-sm);
    }

    .setup-header__subtitle {
      font-size: 1.1rem;
      color: var(--color-text-secondary);
      max-width: 500px;
      margin: 0 auto;
    }

    /* Step sections */
    .step-section {
      margin-bottom: var(--space-2xl);
      padding-bottom: var(--space-2xl);
      border-bottom: 1px solid var(--color-border);
    }

    .step-section:last-of-type {
      border-bottom: none;
    }

    .step-header {
      display: flex;
      align-items: flex-start;
      gap: var(--space-md);
      margin-bottom: var(--space-lg);
      text-align: left;
    }

    .step-number {
      width: 40px;
      height: 40px;
      background: var(--color-primary);
      color: var(--color-bg);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: var(--font-display);
      font-size: 1.25rem;
      font-weight: 700;
      flex-shrink: 0;
    }

    .step-title {
      font-family: var(--font-display);
      font-size: 1.75rem;
      font-weight: 600;
      color: var(--color-text);
      text-transform: uppercase;
      margin-bottom: 4px;
    }

    .step-time {
      font-family: var(--font-mono);
      font-size: 0.75rem;
      color: var(--color-text-muted);
    }

    /* Platform tabs */
    .platform-tabs {
      display: flex;
      gap: var(--space-sm);
      margin-bottom: var(--space-lg);
    }

    .platform-tab {
      flex: 1;
      padding: var(--space-md);
      background: var(--color-bg-card);
      border: 2px solid var(--color-border);
      border-radius: var(--radius-md);
      text-align: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .platform-tab:hover {
      border-color: var(--color-text-muted);
    }

    .platform-tab--active {
      border-color: var(--color-primary);
      background: var(--color-primary-glow);
    }

    .platform-tab--android.platform-tab--active {
      border-color: #3DDC84;
      background: rgba(61, 220, 132, 0.1);
    }

    .platform-tab--ios.platform-tab--active {
      border-color: #007AFF;
      background: rgba(0, 122, 255, 0.1);
    }

    .platform-tab__icon {
      font-size: 1.5rem;
      margin-bottom: var(--space-xs);
    }

    .platform-tab__label {
      font-size: 0.875rem;
      font-weight: 600;
      color: var(--color-text);
    }

    /* Platform content */
    .platform-content {
      display: none;
    }

    .platform-content--active {
      display: block;
    }

    /* Instruction steps */
    .instruction-list {
      background: var(--color-bg-card);
      border: 1px solid var(--color-border);
      border-radius: var(--radius-md);
      padding: var(--space-lg);
    }

    .instruction-item {
      display: flex;
      gap: var(--space-md);
      padding: var(--space-md) 0;
      border-bottom: 1px solid var(--color-border);
    }

    .instruction-item:last-child {
      border-bottom: none;
      padding-bottom: 0;
    }

    .instruction-item:first-child {
      padding-top: 0;
    }

    .instruction-num {
      width: 24px;
      height: 24px;
      background: var(--color-text-muted);
      color: var(--color-bg);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 0.75rem;
      flex-shrink: 0;
    }

    .instruction-text strong {
      color: var(--color-text);
      display: block;
      margin-bottom: 2px;
    }

    .instruction-text p {
      color: var(--color-text-secondary);
      font-size: 0.875rem;
      margin: 0;
    }

    .path-code {
      display: inline;
      background: var(--color-bg);
      padding: 2px 8px;
      border-radius: 4px;
      font-family: var(--font-mono);
      font-size: 0.75rem;
      color: var(--color-accent);
    }

    /* QR section */
    .qr-section {
      text-align: center;
      margin: var(--space-lg) 0;
    }

    .qr-box {
      display: inline-block;
      background: white;
      padding: var(--space-lg);
      border-radius: var(--radius-lg);
      margin-bottom: var(--space-md);
    }

    .qr-box canvas {
      display: block;
      width: 220px;
      height: 220px;
    }

    .url-display {
      background: var(--color-bg-input);
      border: 1px solid var(--color-border);
      border-radius: var(--radius-sm);
      padding: var(--space-md) var(--space-lg);
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 400px;
      margin: 0 auto;
    }

    .url-display__text {
      font-family: var(--font-mono);
      font-size: 0.8rem;
      color: var(--color-accent);
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      flex: 1;
    }

    .url-display__copy {
      background: var(--color-bg-hover);
      border: none;
      color: var(--color-text);
      cursor: pointer;
      padding: var(--space-xs) var(--space-sm);
      font-size: 0.875rem;
      border-radius: var(--radius-sm);
      transition: all 0.2s ease;
      flex-shrink: 0;
      margin-left: var(--space-sm);
    }

    .url-display__copy:hover {
      background: var(--color-primary);
      color: var(--color-bg);
    }

    .url-display__copy.copied {
      background: var(--color-accent);
      color: var(--color-bg);
    }

    /* Settings table */
    .settings-table {
      width: 100%;
      border-collapse: collapse;
      margin: var(--space-lg) 0;
      font-size: 0.875rem;
    }

    .settings-table th {
      text-align: left;
      padding: var(--space-sm) var(--space-md);
      background: var(--color-bg-input);
      color: var(--color-text-muted);
      font-size: 0.7rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.1em;
    }

    .settings-table td {
      padding: var(--space-sm) var(--space-md);
      border-bottom: 1px solid var(--color-border);
      vertical-align: top;
    }

    .settings-table tr:last-child td {
      border-bottom: none;
    }

    .setting-name {
      color: var(--color-text);
      font-weight: 500;
    }

    .setting-path {
      font-family: var(--font-mono);
      font-size: 0.7rem;
      color: var(--color-text-muted);
    }

    .setting-value {
      font-family: var(--font-mono);
      color: var(--color-accent);
    }

    .setting-why {
      color: var(--color-text-secondary);
      font-size: 0.8rem;
    }

    /* Info box styles */
    .info-box--success {
      background: var(--color-success-bg);
      border: 1px solid rgba(6, 214, 160, 0.25);
    }

    .info-box--success .info-box-title {
      color: var(--color-success);
    }

    /* Warning box */
    .warning-box {
      background: var(--color-primary-glow);
      border: 1px solid rgba(232, 93, 4, 0.3);
      border-radius: var(--radius-md);
      padding: var(--space-lg);
      margin: var(--space-lg) 0;
    }

    .warning-box__header {
      display: flex;
      align-items: center;
      gap: var(--space-sm);
      margin-bottom: var(--space-sm);
    }

    .warning-box__title {
      font-size: 0.875rem;
      font-weight: 600;
      color: var(--color-primary);
    }

    .warning-box__content {
      font-size: 0.875rem;
      color: var(--color-text);
      line-height: 1.5;
    }

    /* Collapsible */
    .collapsible {
      border: 1px solid var(--color-border);
      border-radius: var(--radius-md);
      margin: var(--space-md) 0;
      overflow: hidden;
    }

    .collapsible__header {
      display: flex;
      align-items: center;
      gap: var(--space-sm);
      padding: var(--space-md) var(--space-lg);
      background: var(--color-bg-card);
      cursor: pointer;
      transition: background 0.2s ease;
    }

    .collapsible__header:hover {
      background: var(--color-bg-hover);
    }

    .collapsible__icon {
      font-size: 1rem;
    }

    .collapsible__title {
      font-size: 0.875rem;
      font-weight: 500;
      color: var(--color-text);
      flex-grow: 1;
    }

    .collapsible__arrow {
      color: var(--color-text-muted);
      transition: transform 0.2s ease;
      font-size: 0.75rem;
    }

    .collapsible--open .collapsible__arrow {
      transform: rotate(180deg);
    }

    .collapsible__content {
      padding: var(--space-lg);
      background: var(--color-bg-card);
      border-top: 1px solid var(--color-border);
      font-size: 0.875rem;
      color: var(--color-text-secondary);
      line-height: 1.7;
      display: none;
    }

    .collapsible--open .collapsible__content {
      display: block;
    }

    /* Done section */
    .done-section {
      text-align: center;
      padding: var(--space-2xl) 0;
    }

    .done-section__icon {
      font-size: 4rem;
      margin-bottom: var(--space-lg);
    }

    .done-section__title {
      font-family: var(--font-display);
      font-size: 2.25rem;
      color: var(--color-text);
      text-transform: uppercase;
      margin-bottom: var(--space-sm);
    }

    .done-section__text {
      color: var(--color-text-secondary);
      margin-bottom: var(--space-xl);
      max-width: 400px;
      margin-left: auto;
      margin-right: auto;
    }

    .done-buttons {
      display: flex;
      gap: var(--space-md);
      justify-content: center;
      flex-wrap: wrap;
    }

    @media (max-width: 600px) {
      .setup-header__title { font-size: 2rem; }
      .step-title { font-size: 1.4rem; }
      .platform-tabs { flex-direction: column; }
      .settings-table { font-size: 0.75rem; }
      .settings-table th, .settings-table td { padding: var(--space-xs) var(--space-sm); }
      .done-buttons { flex-direction: column; align-items: stretch; }
    }
  </style>
</head>
<body>

  <div class="container">

    <!-- BACK NAV -->
    <a href="/" class="back-link">&larr; Back to Nodeville</a>

    <!-- HEADER -->
    <header class="setup-header">
      <div class="setup-header__icon">&#128640;</div>
      <h1 class="setup-header__title">Setup Guide</h1>
      <p class="setup-header__subtitle">
        Join Nashville's mesh network in about 10 minutes.
      </p>
    </header>

    <!-- ==================== STEP 1: INSTALL APP ==================== -->
    <section class="step-section">
      <div class="step-header">
        <div class="step-number">1</div>
        <div>
          <h2 class="step-title">Install the App</h2>
          <p class="step-time">~1 minute</p>
        </div>
      </div>

      <p style="color: var(--color-text-secondary); margin-bottom: var(--space-lg);">
        Download the official Meshtastic app for your phone. It's free.
      </p>

      <div class="app-badges">
        <a href="https://play.google.com/store/apps/details?id=com.geeksville.mesh" class="app-badge">
          <span class="store-icon">&#129302;</span>
          <div>
            <div class="store-text">Get it on</div>
            <div class="store-name">Google Play</div>
          </div>
        </a>
        <a href="https://apps.apple.com/app/meshtastic/id1586432531" class="app-badge">
          <span class="store-icon">&#127822;</span>
          <div>
            <div class="store-text">Download on the</div>
            <div class="store-name">App Store</div>
          </div>
        </a>
      </div>
    </section>

    <!-- ==================== STEP 2: PAIR DEVICE ==================== -->
    <section class="step-section" data-step="pair">
      <div class="step-header">
        <div class="step-number">2</div>
        <div>
          <h2 class="step-title">Pair Your Device</h2>
          <p class="step-time">~2 minutes</p>
        </div>
      </div>

      <!-- Platform Tabs -->
      <div class="platform-tabs" data-platform-group="pair">
        <div class="platform-tab platform-tab--android platform-tab--active" data-platform="android">
          <div class="platform-tab__icon">&#129302;</div>
          <div class="platform-tab__label">Android</div>
        </div>
        <div class="platform-tab platform-tab--ios" data-platform="ios">
          <div class="platform-tab__icon">&#127822;</div>
          <div class="platform-tab__label">iPhone</div>
        </div>
      </div>

      <!-- Android Instructions -->
      <div class="platform-content platform-content--active" data-platform-content="pair-android">
        <div class="instruction-list">
          <div class="instruction-item">
            <div class="instruction-num">1</div>
            <div class="instruction-text">
              <strong>Turn on your Meshtastic device</strong>
              <p>Hold the power button until the screen lights up (if it has one)</p>
            </div>
          </div>
          <div class="instruction-item">
            <div class="instruction-num">2</div>
            <div class="instruction-text">
              <strong>Open the Meshtastic app</strong>
              <p>Go to the <span class="path-code">Connection</span> tab (bottom nav)</p>
            </div>
          </div>
          <div class="instruction-item">
            <div class="instruction-num">3</div>
            <div class="instruction-text">
              <strong>Select your device from the list</strong>
              <p>It usually shows as "Meshtastic_XXXX" where XXXX is random letters</p>
            </div>
          </div>
          <div class="instruction-item">
            <div class="instruction-num">4</div>
            <div class="instruction-text">
              <strong>Enter PIN: <span class="path-code">123456</span></strong>
              <p>This is the factory default. You'll change it in Step 5.</p>
            </div>
          </div>
        </div>
      </div>

      <!-- iOS Instructions -->
      <div class="platform-content" data-platform-content="pair-ios">
        <div class="instruction-list">
          <div class="instruction-item">
            <div class="instruction-num">1</div>
            <div class="instruction-text">
              <strong>Turn on your Meshtastic device</strong>
              <p>Hold the power button until the screen lights up (if it has one)</p>
            </div>
          </div>
          <div class="instruction-item">
            <div class="instruction-num">2</div>
            <div class="instruction-text">
              <strong>Open the Meshtastic app</strong>
              <p>Go to the <span class="path-code">Settings</span> tab</p>
            </div>
          </div>
          <div class="instruction-item">
            <div class="instruction-num">3</div>
            <div class="instruction-text">
              <strong>Tap "Connect to Radio"</strong>
              <p>The app will scan for nearby Bluetooth devices</p>
            </div>
          </div>
          <div class="instruction-item">
            <div class="instruction-num">4</div>
            <div class="instruction-text">
              <strong>Select your device and enter PIN: <span class="path-code">123456</span></strong>
              <p>This is the factory default. You'll change it in Step 5.</p>
            </div>
          </div>
        </div>
      </div>

      <div class="collapsible">
        <div class="collapsible__header">
          <span class="collapsible__icon">&#10067;</span>
          <span class="collapsible__title">Device not showing up?</span>
          <span class="collapsible__arrow">&#9660;</span>
        </div>
        <div class="collapsible__content">
          <strong>Make sure Bluetooth is enabled</strong> on your phone.<br><br>
          <strong>Try restarting the device</strong> &mdash; hold power for 10 seconds to turn off, then turn back on.<br><br>
          <strong>Move closer</strong> &mdash; Bluetooth range is about 30 feet.<br><br>
          <strong>Check if it's paired to another phone</strong> &mdash; some devices only connect to one phone at a time.
        </div>
      </div>
    </section>

    <!-- ==================== STEP 3: JOIN NETWORK ==================== -->
    <section class="step-section" data-step="join">
      <div class="step-header">
        <div class="step-number">3</div>
        <div>
          <h2 class="step-title">Join the Nashville Network</h2>
          <p class="step-time">~1 minute</p>
        </div>
      </div>

      <p style="color: var(--color-text-secondary); margin-bottom: var(--space-lg);">
        Scan this QR code to configure your device for Nashville's Medium Fast mesh.
      </p>

      <!-- QR Code -->
      <div class="qr-section">
        <div class="qr-box">
          <canvas id="setup-qr" data-qr="network" data-size="220"></canvas>
        </div>
        <div class="url-display">
          <span class="url-display__text" id="network-url" data-network-url>Loading...</span>
          <button class="url-display__copy copy-btn" data-copy-target="network-url">&#128203; Copy</button>
        </div>
      </div>

      <!-- Platform Tabs -->
      <div class="platform-tabs" data-platform-group="scan">
        <div class="platform-tab platform-tab--android platform-tab--active" data-platform="android">
          <div class="platform-tab__icon">&#129302;</div>
          <div class="platform-tab__label">Android</div>
        </div>
        <div class="platform-tab platform-tab--ios" data-platform="ios">
          <div class="platform-tab__icon">&#127822;</div>
          <div class="platform-tab__label">iPhone</div>
        </div>
      </div>

      <!-- Android Instructions -->
      <div class="platform-content platform-content--active" data-platform-content="scan-android">
        <div class="instruction-list">
          <div class="instruction-item">
            <div class="instruction-num">1</div>
            <div class="instruction-text">
              <strong>In the Meshtastic app, go to Messages tab</strong>
              <p>This is the speech bubble icon in the bottom navigation</p>
            </div>
          </div>
          <div class="instruction-item">
            <div class="instruction-num">2</div>
            <div class="instruction-text">
              <strong>Tap the floating button (bottom right) with the QR icon</strong>
              <p>Or go to <span class="path-code">Settings &rarr; Channels &rarr; Scan QR Code</span></p>
            </div>
          </div>
          <div class="instruction-item">
            <div class="instruction-num">3</div>
            <div class="instruction-text">
              <strong>Point your camera at the QR code above</strong>
              <p>Or tap "Paste URL" and paste the link if camera isn't working</p>
            </div>
          </div>
          <div class="instruction-item">
            <div class="instruction-num">4</div>
            <div class="instruction-text">
              <strong>Choose "Replace All Channels"</strong>
              <p>This applies the Nashville network settings to your device</p>
            </div>
          </div>
        </div>
      </div>

      <!-- iOS Instructions -->
      <div class="platform-content" data-platform-content="scan-ios">
        <div class="instruction-list">
          <div class="instruction-item">
            <div class="instruction-num">1</div>
            <div class="instruction-text">
              <strong>Open your iPhone's Camera app</strong>
              <p>Not the Meshtastic app &mdash; use the regular Camera</p>
            </div>
          </div>
          <div class="instruction-item">
            <div class="instruction-num">2</div>
            <div class="instruction-text">
              <strong>Point it at the QR code above</strong>
              <p>A yellow banner will appear at the top of the screen</p>
            </div>
          </div>
          <div class="instruction-item">
            <div class="instruction-num">3</div>
            <div class="instruction-text">
              <strong>Tap the banner to open in Meshtastic</strong>
              <p>If it opens Safari instead, tap "Open in Meshtastic" or copy the URL</p>
            </div>
          </div>
          <div class="instruction-item">
            <div class="instruction-num">4</div>
            <div class="instruction-text">
              <strong>Tap "Replace Channels" when prompted</strong>
              <p>This applies the Nashville network settings to your device</p>
            </div>
          </div>
        </div>

        <div class="collapsible">
          <div class="collapsible__header">
            <span class="collapsible__icon">&#10067;</span>
            <span class="collapsible__title">QR code opens Safari instead of the app?</span>
            <span class="collapsible__arrow">&#9660;</span>
          </div>
          <div class="collapsible__content">
            Copy the URL below the QR code, then in the Meshtastic app go to:<br><br>
            <span class="path-code">Settings &rarr; Radio Configuration &rarr; Channels</span><br><br>
            Look for a "+" button or option to add/import a channel, and paste the URL there.
          </div>
        </div>
      </div>

      <div class="info-box info-box--success">
        <div class="info-box-header">
          <span class="info-box-title">&#128295; What this configures</span>
        </div>
        <div class="info-box-content" style="display: block;">
          <strong>Region:</strong> US &middot; <strong>Modem:</strong> Medium Fast &middot; <strong>Hop Limit:</strong> 7<br>
          <strong>Channel:</strong> Nashville public mesh (blank name = TN convention)<br>
          <strong>OK to MQTT:</strong> Enabled (helps grow the network map)
        </div>
      </div>

      <div class="collapsible">
        <div class="collapsible__header">
          <span class="collapsible__icon">&#127760;</span>
          <span class="collapsible__title">What is "OK to MQTT"?</span>
          <span class="collapsible__arrow">&#9660;</span>
        </div>
        <div class="collapsible__content">
          <strong>You're helping the network just by using it.</strong><br><br>
          When "OK to MQTT" is enabled, other nodes with internet connections can forward your position and activity to the community map at <a href="https://meshmap.net" target="_blank" style="color: var(--color-accent);">meshmap.net</a>. This helps everyone see network coverage and find other users nearby.<br><br>
          <strong>What gets shared:</strong> Your node name, approximate position (~1.5km precision), and message routing statistics.<br><br>
          <strong>What stays private:</strong> Message contents are never shared via MQTT unless you're on a channel that explicitly uploads them.<br><br>
          If you prefer not to appear on public maps, you can disable this later in <span class="path-code">Settings &rarr; Radio Config &rarr; LoRa &rarr; OK to MQTT</span>.
        </div>
      </div>

      <div class="warning-box" style="background: var(--color-bg-card); border-color: var(--color-border);">
        <div class="warning-box__header">
          <span>&#9888;&#65039;</span>
          <span class="warning-box__title">Heads up: This replaces your channels</span>
        </div>
        <p class="warning-box__content">
          Scanning this QR code will replace all existing channels on your device. If you already have channels you want to keep, write them down first.
        </p>
      </div>
    </section>

    <!-- ==================== STEP 4: SET YOUR NAME ==================== -->
    <section class="step-section" data-step="name">
      <div class="step-header">
        <div class="step-number">4</div>
        <div>
          <h2 class="step-title">Set Your Name</h2>
          <p class="step-time">~1 minute</p>
        </div>
      </div>

      <p style="color: var(--color-text-secondary); margin-bottom: var(--space-lg);">
        This is how you'll appear to other people on the mesh.
      </p>

      <!-- Platform Tabs -->
      <div class="platform-tabs" data-platform-group="name">
        <div class="platform-tab platform-tab--android platform-tab--active" data-platform="android">
          <div class="platform-tab__icon">&#129302;</div>
          <div class="platform-tab__label">Android</div>
        </div>
        <div class="platform-tab platform-tab--ios" data-platform="ios">
          <div class="platform-tab__icon">&#127822;</div>
          <div class="platform-tab__label">iPhone</div>
        </div>
      </div>

      <!-- Android Instructions -->
      <div class="platform-content platform-content--active" data-platform-content="name-android">
        <div class="instruction-list">
          <div class="instruction-item">
            <div class="instruction-num">1</div>
            <div class="instruction-text">
              <strong>Go to <span class="path-code">Settings &rarr; User</span></strong>
            </div>
          </div>
          <div class="instruction-item">
            <div class="instruction-num">2</div>
            <div class="instruction-text">
              <strong>Set your Long Name</strong>
              <p>Example: "Sarah @ East Nashville" &mdash; this is your display name</p>
            </div>
          </div>
          <div class="instruction-item">
            <div class="instruction-num">3</div>
            <div class="instruction-text">
              <strong>Set your Short Name (4 characters max)</strong>
              <p>Example: "SARA" &mdash; used when space is limited</p>
            </div>
          </div>
          <div class="instruction-item">
            <div class="instruction-num">4</div>
            <div class="instruction-text">
              <strong>Tap Save</strong>
              <p>Your device will reboot with your new name</p>
            </div>
          </div>
        </div>
      </div>

      <!-- iOS Instructions -->
      <div class="platform-content" data-platform-content="name-ios">
        <div class="instruction-list">
          <div class="instruction-item">
            <div class="instruction-num">1</div>
            <div class="instruction-text">
              <strong>Go to <span class="path-code">Settings &rarr; User</span></strong>
            </div>
          </div>
          <div class="instruction-item">
            <div class="instruction-num">2</div>
            <div class="instruction-text">
              <strong>Set your Long Name</strong>
              <p>Example: "Sarah @ East Nashville" &mdash; this is your display name</p>
            </div>
          </div>
          <div class="instruction-item">
            <div class="instruction-num">3</div>
            <div class="instruction-text">
              <strong>Set your Short Name (4 characters max)</strong>
              <p>Example: "SARA" &mdash; used when space is limited</p>
            </div>
          </div>
          <div class="instruction-item">
            <div class="instruction-num">4</div>
            <div class="instruction-text">
              <strong>Tap Save</strong>
              <p>Your device will reboot with your new name</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ==================== STEP 5: SECURE YOUR PIN ==================== -->
    <section class="step-section" data-step="secure">
      <div class="step-header">
        <div class="step-number">5</div>
        <div>
          <h2 class="step-title">Change Your Bluetooth PIN</h2>
          <p class="step-time">~1 minute</p>
        </div>
      </div>

      <div class="warning-box">
        <div class="warning-box__header">
          <span>&#9888;&#65039;</span>
          <span class="warning-box__title">Don't skip this step</span>
        </div>
        <p class="warning-box__content">
          The default PIN (<strong>123456</strong>) is public knowledge. Anyone within ~30 feet could connect to your device, read your messages, or send messages as you.
        </p>
      </div>

      <!-- Platform Tabs -->
      <div class="platform-tabs" data-platform-group="pin">
        <div class="platform-tab platform-tab--android platform-tab--active" data-platform="android">
          <div class="platform-tab__icon">&#129302;</div>
          <div class="platform-tab__label">Android</div>
        </div>
        <div class="platform-tab platform-tab--ios" data-platform="ios">
          <div class="platform-tab__icon">&#127822;</div>
          <div class="platform-tab__label">iPhone</div>
        </div>
      </div>

      <!-- Android Instructions -->
      <div class="platform-content platform-content--active" data-platform-content="pin-android">
        <div class="instruction-list">
          <div class="instruction-item">
            <div class="instruction-num">1</div>
            <div class="instruction-text">
              <strong>Go to <span class="path-code">Settings &rarr; Radio Config &rarr; Bluetooth</span></strong>
            </div>
          </div>
          <div class="instruction-item">
            <div class="instruction-num">2</div>
            <div class="instruction-text">
              <strong>Make sure Pairing Mode is set to "Fixed PIN"</strong>
              <p>This should already be selected</p>
            </div>
          </div>
          <div class="instruction-item">
            <div class="instruction-num">3</div>
            <div class="instruction-text">
              <strong>Enter a new 6-digit PIN</strong>
              <p>Pick something you'll remember (but not 123456!)</p>
            </div>
          </div>
          <div class="instruction-item">
            <div class="instruction-num">4</div>
            <div class="instruction-text">
              <strong>Tap Save</strong>
              <p>Write down your PIN somewhere safe &mdash; you'll need it if you switch phones</p>
            </div>
          </div>
        </div>
      </div>

      <!-- iOS Instructions -->
      <div class="platform-content" data-platform-content="pin-ios">
        <div class="instruction-list">
          <div class="instruction-item">
            <div class="instruction-num">1</div>
            <div class="instruction-text">
              <strong>Go to <span class="path-code">Settings &rarr; Radio Configuration &rarr; Bluetooth</span></strong>
            </div>
          </div>
          <div class="instruction-item">
            <div class="instruction-num">2</div>
            <div class="instruction-text">
              <strong>Make sure Pairing Mode is set to "Fixed PIN"</strong>
              <p>This should already be selected</p>
            </div>
          </div>
          <div class="instruction-item">
            <div class="instruction-num">3</div>
            <div class="instruction-text">
              <strong>Enter a new 6-digit PIN</strong>
              <p>Pick something you'll remember (but not 123456!)</p>
            </div>
          </div>
          <div class="instruction-item">
            <div class="instruction-num">4</div>
            <div class="instruction-text">
              <strong>Tap Save</strong>
              <p>Write down your PIN somewhere safe &mdash; you'll need it if you switch phones</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ==================== STEP 6: OPTIMIZE SETTINGS ==================== -->
    <section class="step-section" data-step="optimize">
      <div class="step-header">
        <div class="step-number">6</div>
        <div>
          <h2 class="step-title">Optimize for Nashville</h2>
          <p class="step-time">~2 minutes (optional but recommended)</p>
        </div>
      </div>

      <p style="color: var(--color-text-secondary); margin-bottom: var(--space-lg);">
        The QR code set up your channels, but these additional settings help the network run smoothly and save your battery.
      </p>

      <table class="settings-table">
        <thead>
          <tr>
            <th>Setting</th>
            <th>Value</th>
            <th>Why</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>
              <div class="setting-name">Position Broadcast</div>
              <div class="setting-path">Radio Config &rarr; Position &rarr; Broadcast Interval</div>
            </td>
            <td class="setting-value">1 hour</td>
            <td class="setting-why">Default 15min is too chatty. 1hr is plenty for a city mesh.</td>
          </tr>
          <tr>
            <td>
              <div class="setting-name">Smart Position</div>
              <div class="setting-path">Radio Config &rarr; Position &rarr; Smart Position</div>
            </td>
            <td class="setting-value">ON</td>
            <td class="setting-why">Sends position when you move significantly. Good if you're mobile.</td>
          </tr>
          <tr>
            <td>
              <div class="setting-name">Device Metrics</div>
              <div class="setting-path">Module Config &rarr; Telemetry &rarr; Interval</div>
            </td>
            <td class="setting-value">1 hour</td>
            <td class="setting-why">Battery/voltage updates. Default 15min clutters the mesh.</td>
          </tr>
          <tr>
            <td>
              <div class="setting-name">Device Role</div>
              <div class="setting-path">Radio Config &rarr; Device &rarr; Role</div>
            </td>
            <td class="setting-value">CLIENT</td>
            <td class="setting-why">Default is fine. Only change if you're running a dedicated router.</td>
          </tr>
        </tbody>
      </table>

      <div class="info-box">
        <div class="info-box-header">
          <span class="info-box-title">&#9889; Why Medium Fast?</span>
          <span class="info-box-toggle">&#9660;</span>
        </div>
        <div class="info-box-content">
          Nashville's mesh uses <strong>Medium Fast</strong> instead of the default Long Fast. It has shorter range per hop (~2km vs ~5km) but faster message throughput. In a city with lots of nodes, this means less congestion and quicker delivery. The hop limit of 6 still covers the metro area.
        </div>
      </div>
    </section>

    <!-- ==================== DONE ==================== -->
    <section class="done-section">
      <div class="done-section__icon">&#127881;</div>
      <h2 class="done-section__title">You're on the Mesh!</h2>
      <p class="done-section__text">
        Go to the Messages tab and say hello. Your message will hop through Nashville until someone replies.
      </p>

      <div class="done-buttons">
        <a href="/encrypt/" class="btn btn-primary">
          Set up private messaging &rarr;
        </a>
        <a href="/advanced/" class="btn btn-secondary">
          Advanced settings
        </a>
      </div>
    </section>

    <!-- FOOTER -->
    <footer class="site-footer">
      <p class="footer-text">
        Part of the <a href="https://hyphae.social">Hyphae Network</a> &middot; Built for Nashville
      </p>
    </footer>

  </div>

  <script src="/js/qr-generator.js"></script>
  <script>
    // Platform tab switching
    document.querySelectorAll('.platform-tabs').forEach(tabGroup => {
      const groupName = tabGroup.dataset.platformGroup;
      const tabs = tabGroup.querySelectorAll('.platform-tab');

      tabs.forEach(tab => {
        tab.addEventListener('click', () => {
          const platform = tab.dataset.platform;

          // Update tab active states
          tabs.forEach(t => t.classList.remove('platform-tab--active'));
          tab.classList.add('platform-tab--active');

          // Update content visibility
          const section = tabGroup.closest('.step-section');
          section.querySelectorAll('.platform-content').forEach(content => {
            content.classList.remove('platform-content--active');
          });

          const targetContent = section.querySelector(`[data-platform-content="${groupName}-${platform}"]`);
          if (targetContent) {
            targetContent.classList.add('platform-content--active');
          }
        });
      });
    });

    // Collapsible sections
    document.querySelectorAll('.collapsible__header').forEach(header => {
      header.addEventListener('click', (e) => {
        e.stopPropagation();
        header.closest('.collapsible').classList.toggle('collapsible--open');
      });
    });

    // Info box collapsibles
    document.querySelectorAll('.info-box-header').forEach(header => {
      header.addEventListener('click', () => {
        header.closest('.info-box').classList.toggle('open');
      });
    });

    // Copy button functionality
    document.querySelectorAll('.copy-btn').forEach(btn => {
      btn.addEventListener('click', async () => {
        const targetId = btn.dataset.copyTarget;
        const target = document.getElementById(targetId);
        if (!target) return;

        const text = target.textContent || target.value;

        try {
          await navigator.clipboard.writeText(text.trim());
          const originalText = btn.innerHTML;
          btn.classList.add('copied');
          btn.innerHTML = '&#10003; Copied';

          setTimeout(() => {
            btn.classList.remove('copied');
            btn.innerHTML = originalText;
          }, 2000);
        } catch (err) {
          // Fallback for older browsers
          const textarea = document.createElement('textarea');
          textarea.value = text.trim();
          textarea.style.position = 'fixed';
          textarea.style.opacity = '0';
          document.body.appendChild(textarea);
          textarea.select();
          document.execCommand('copy');
          document.body.removeChild(textarea);

          const originalText = btn.innerHTML;
          btn.classList.add('copied');
          btn.innerHTML = '&#10003; Copied';

          setTimeout(() => {
            btn.classList.remove('copied');
            btn.innerHTML = originalText;
          }, 2000);
        }
      });
    });
  </script>

</body>
</html>
