<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Setup â€” Nodeville</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Barlow+Condensed:wght@400;500;600;700&family=Inter:wght@400;500;600&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    :root {
      --signal-orange: #E85D04;
      --signal-orange-dark: #C44E03;
      --signal-orange-glow: rgba(232, 93, 4, 0.15);
      --static-green: #06D6A0;
      --static-green-dim: rgba(6, 214, 160, 0.12);
      --asphalt: #1A1A22;
      --concrete: #24242E;
      --gravel: #32323E;
      --steel: #4A4A58;
      --fog: #8A8A9A;
      --chalk: #CDCDD8;
      --white: #F5F5F7;
      --error: #EF476F;
      --warning: #FFD166;

      --font-display: 'Barlow Condensed', sans-serif;
      --font-body: 'Inter', -apple-system, sans-serif;
      --font-mono: 'JetBrains Mono', monospace;

      --space-xs: 4px;
      --space-sm: 8px;
      --space-md: 16px;
      --space-lg: 24px;
      --space-xl: 32px;
      --space-2xl: 48px;

      --radius-sm: 6px;
      --radius-md: 10px;
    }

    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: var(--font-body);
      font-size: 16px;
      line-height: 1.6;
      background: var(--asphalt);
      color: var(--chalk);
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
    }

    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background-image: radial-gradient(circle, var(--gravel) 1px, transparent 1px);
      background-size: 32px 32px;
      opacity: 0.5;
      pointer-events: none;
      z-index: -1;
    }

    a { color: inherit; text-decoration: none; }

    .container {
      max-width: 600px;
      margin: 0 auto;
      padding: 0 var(--space-lg);
    }

    /* NAV */
    .nav {
      padding: var(--space-lg) 0;
      border-bottom: 1px solid var(--gravel);
    }

    .nav__back {
      display: inline-flex;
      align-items: center;
      gap: var(--space-sm);
      font-size: 14px;
      color: var(--fog);
      transition: color 0.2s ease;
    }

    .nav__back:hover { color: var(--signal-orange); }

    /* STEP HEADER */
    .step-header {
      text-align: center;
      padding: var(--space-xl) 0 var(--space-2xl);
    }

    .steps {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: var(--space-lg);
    }

    .step__dot {
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: var(--steel);
      position: relative;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .step__dot--complete {
      background: var(--static-green);
    }

    .step__dot--current {
      background: var(--signal-orange);
      box-shadow: 0 0 0 4px var(--signal-orange-glow), 0 0 20px var(--signal-orange-glow);
    }

    .step__dot:hover {
      transform: scale(1.1);
    }

    .step__line {
      width: 48px;
      height: 2px;
      background: var(--steel);
    }

    .step__line--complete {
      background: var(--static-green);
    }

    .step-header__label {
      font-family: var(--font-mono);
      font-size: 12px;
      color: var(--fog);
      text-transform: uppercase;
      letter-spacing: 0.15em;
    }

    /* STEP CONTENT */
    .step-content {
      padding-bottom: var(--space-2xl);
    }

    .step-content__icon {
      font-size: 56px;
      text-align: center;
      margin-bottom: var(--space-lg);
    }

    .step-content__title {
      font-family: var(--font-display);
      font-size: 36px;
      font-weight: 600;
      text-transform: uppercase;
      color: var(--white);
      text-align: center;
      margin-bottom: var(--space-sm);
    }

    .step-content__subtitle {
      text-align: center;
      color: var(--fog);
      font-size: 17px;
      margin-bottom: var(--space-xl);
    }

    /* QR SECTION */
    .qr-section {
      text-align: center;
      margin-bottom: var(--space-xl);
    }

    .qr-container {
      display: inline-block;
      background: var(--white);
      padding: var(--space-lg);
      border-radius: var(--radius-md);
      box-shadow: 0 8px 32px rgba(0,0,0,0.3);
      margin-bottom: var(--space-md);
    }

    .qr-placeholder {
      width: 220px;
      height: 220px;
      background:
        linear-gradient(45deg, #e8e8e8 25%, transparent 25%),
        linear-gradient(-45deg, #e8e8e8 25%, transparent 25%),
        linear-gradient(45deg, transparent 75%, #e8e8e8 75%),
        linear-gradient(-45deg, transparent 75%, #e8e8e8 75%);
      background-size: 16px 16px;
      background-position: 0 0, 0 8px, 8px -8px, -8px 0px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: var(--font-mono);
      font-size: 11px;
      color: #888;
      border-radius: var(--radius-sm);
    }

    .code-block {
      background: var(--gravel);
      border: 1px solid var(--steel);
      border-radius: var(--radius-sm);
      padding: var(--space-md) var(--space-lg);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .code-block__text {
      font-family: var(--font-mono);
      font-size: 13px;
      color: var(--static-green);
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .code-block__copy {
      background: transparent;
      border: none;
      color: var(--fog);
      cursor: pointer;
      padding: var(--space-xs) var(--space-sm);
      font-size: 14px;
      transition: color 0.2s ease;
      flex-shrink: 0;
    }

    .code-block__copy:hover { color: var(--signal-orange); }

    /* INSTRUCTIONS */
    .instructions {
      background: var(--concrete);
      border: 1px solid var(--gravel);
      border-radius: var(--radius-md);
      padding: var(--space-lg);
      margin-bottom: var(--space-xl);
    }

    .instruction {
      display: flex;
      gap: var(--space-md);
      padding: var(--space-md) 0;
      border-bottom: 1px solid var(--gravel);
    }

    .instruction:last-child {
      border-bottom: none;
      padding-bottom: 0;
    }

    .instruction:first-child {
      padding-top: 0;
    }

    .instruction__number {
      width: 28px;
      height: 28px;
      background: var(--signal-orange);
      color: var(--asphalt);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 14px;
      flex-shrink: 0;
    }

    .instruction__text {
      padding-top: 2px;
    }

    .instruction__text strong {
      color: var(--white);
      display: block;
      margin-bottom: 2px;
    }

    .instruction__text p {
      color: var(--fog);
      font-size: 14px;
      margin: 0;
    }

    .instruction__path {
      background: var(--asphalt);
      padding: 2px 8px;
      border-radius: 4px;
      font-family: var(--font-mono);
      font-size: 12px;
      color: var(--static-green);
    }

    /* COLLAPSIBLE */
    .collapsible {
      border: 1px solid var(--gravel);
      border-radius: var(--radius-md);
      margin-bottom: var(--space-md);
      overflow: hidden;
    }

    .collapsible__header {
      display: flex;
      align-items: center;
      gap: var(--space-sm);
      padding: var(--space-md) var(--space-lg);
      background: var(--concrete);
      cursor: pointer;
      transition: background 0.2s ease;
    }

    .collapsible__header:hover { background: var(--gravel); }

    .collapsible__icon { font-size: 16px; }

    .collapsible__title {
      font-size: 14px;
      font-weight: 500;
      color: var(--chalk);
      flex-grow: 1;
    }

    .collapsible__arrow {
      color: var(--fog);
      transition: transform 0.2s ease;
      font-size: 12px;
    }

    .collapsible--open .collapsible__arrow {
      transform: rotate(180deg);
    }

    .collapsible__content {
      padding: var(--space-lg);
      background: var(--concrete);
      border-top: 1px solid var(--gravel);
      font-size: 14px;
      color: var(--fog);
      line-height: 1.7;
      display: none;
    }

    .collapsible--open .collapsible__content {
      display: block;
    }

    /* WARNING BOX */
    .warning-box {
      background: var(--signal-orange-glow);
      border: 1px solid rgba(232, 93, 4, 0.3);
      border-radius: var(--radius-md);
      padding: var(--space-lg);
      margin-bottom: var(--space-xl);
    }

    .warning-box__header {
      display: flex;
      align-items: center;
      gap: var(--space-sm);
      margin-bottom: var(--space-sm);
    }

    .warning-box__title {
      font-size: 14px;
      font-weight: 600;
      color: var(--signal-orange);
    }

    .warning-box__content {
      font-size: 14px;
      color: var(--chalk);
      line-height: 1.5;
    }

    /* NAV BUTTONS */
    .nav-buttons {
      display: flex;
      gap: var(--space-md);
    }

    .btn {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: var(--space-sm);
      padding: 16px var(--space-lg);
      border-radius: var(--radius-sm);
      font-weight: 600;
      font-size: 15px;
      transition: all 0.2s ease;
      border: 2px solid transparent;
    }

    .btn--primary {
      background: var(--signal-orange);
      color: var(--asphalt);
      border-color: var(--signal-orange);
    }

    .btn--primary:hover {
      background: var(--signal-orange-dark);
      border-color: var(--signal-orange-dark);
    }

    .btn--secondary {
      background: transparent;
      color: var(--fog);
      border-color: var(--gravel);
    }

    .btn--secondary:hover {
      border-color: var(--signal-orange);
      color: var(--signal-orange);
    }

    /* FOOTER */
    .site-footer {
      padding: var(--space-2xl) 0;
      border-top: 1px solid var(--gravel);
      margin-top: var(--space-xl);
      text-align: center;
    }

    .footer__credit {
      font-size: 13px;
      color: var(--steel);
    }

    .footer__credit a { color: var(--static-green); }

    @media (max-width: 500px) {
      .step-content__title { font-size: 28px; }
      .step__line { width: 24px; }
      .qr-placeholder { width: 180px; height: 180px; }
      .nav-buttons { flex-direction: column; }
    }
  </style>
</head>
<body>

  <div class="container">

    <!-- NAV -->
    <nav class="nav">
      <a href="/" class="nav__back">&larr; Back to Nodeville</a>
    </nav>

    <!-- STEP HEADER -->
    <header class="step-header">
      <div class="steps">
        <a href="/setup/install/" class="step__dot step__dot--complete" title="Install App"></a>
        <div class="step__line step__line--complete"></div>
        <a href="/setup/pair/" class="step__dot step__dot--complete" title="Pair Device"></a>
        <div class="step__line step__line--complete"></div>
        <div class="step__dot step__dot--current" title="Join Network"></div>
        <div class="step__line"></div>
        <a href="/setup/name/" class="step__dot" title="Set Name"></a>
        <div class="step__line"></div>
        <a href="/setup/secure/" class="step__dot" title="Secure PIN"></a>
      </div>
      <p class="step-header__label">Step 3 of 5</p>
    </header>

    <!-- STEP CONTENT -->
    <main class="step-content">

      <div class="step-content__icon">&#128225;</div>
      <h1 class="step-content__title">Join the Network</h1>
      <p class="step-content__subtitle">Scan this code to configure your device for the Nashville mesh.</p>

      <!-- QR CODE -->
      <div class="qr-section">
        <div class="qr-container">
          <div class="qr-placeholder">[QR CODE]</div>
        </div>
        <div class="code-block">
          <span class="code-block__text">https://meshtastic.org/e/#CgUYAyIBAQ...</span>
          <button class="code-block__copy" title="Copy URL">&#128203;</button>
        </div>
      </div>

      <!-- INSTRUCTIONS -->
      <div class="instructions">
        <div class="instruction">
          <div class="instruction__number">1</div>
          <div class="instruction__text">
            <strong>Open the Meshtastic app</strong>
            <p>Make sure your device is connected via Bluetooth</p>
          </div>
        </div>
        <div class="instruction">
          <div class="instruction__number">2</div>
          <div class="instruction__text">
            <strong>Tap the QR scanner icon</strong>
            <p>Or go to <span class="instruction__path">Settings &rarr; Channels &rarr; Scan QR</span></p>
          </div>
        </div>
        <div class="instruction">
          <div class="instruction__number">3</div>
          <div class="instruction__text">
            <strong>Point your camera at the code above</strong>
            <p>Or paste the URL if the camera isn't working</p>
          </div>
        </div>
        <div class="instruction">
          <div class="instruction__number">4</div>
          <div class="instruction__text">
            <strong>Choose "Replace All Channels"</strong>
            <p>This applies the full Nashville network configuration</p>
          </div>
        </div>
        <div class="instruction">
          <div class="instruction__number">5</div>
          <div class="instruction__text">
            <strong>Wait for reboot</strong>
            <p>Your device restarts with new settings (~10 seconds)</p>
          </div>
        </div>
      </div>

      <!-- COLLAPSIBLES -->
      <div class="collapsible collapsible--open" onclick="this.classList.toggle('collapsible--open')">
        <div class="collapsible__header">
          <span class="collapsible__icon">&#128295;</span>
          <span class="collapsible__title">What does this configure?</span>
          <span class="collapsible__arrow">&#9660;</span>
        </div>
        <div class="collapsible__content">
          <strong>Region:</strong> US (legal frequencies for North America)<br>
          <strong>Modem Preset:</strong> Medium Fast (balanced range & speed)<br>
          <strong>Hop Limit:</strong> 6 (messages relay up to 6 times)<br>
          <strong>Primary Channel:</strong> Nashville public mesh (blank name = TN convention)<br>
          <strong>MQTT:</strong> Enabled for internet bridging<br>
          <strong>Position Precision:</strong> ~1.5km (city-level, not exact)
        </div>
      </div>

      <div class="collapsible" onclick="this.classList.toggle('collapsible--open')">
        <div class="collapsible__header">
          <span class="collapsible__icon">&#10067;</span>
          <span class="collapsible__title">Troubleshooting</span>
          <span class="collapsible__arrow">&#9660;</span>
        </div>
        <div class="collapsible__content">
          <strong>QR code not scanning?</strong><br>
          Make sure your device is connected via Bluetooth first. Try copying the URL instead.<br><br>
          <strong>"Open with Meshtastic" not appearing?</strong><br>
          Android: Settings &rarr; Apps &rarr; Meshtastic &rarr; Open by default &rarr; Enable meshtastic.org<br><br>
          <strong>Nothing happening after scan?</strong><br>
          Check the Meshtastic app for a confirmation popup. You may need to approve the channel change.
        </div>
      </div>

      <!-- WARNING -->
      <div class="warning-box">
        <div class="warning-box__header">
          <span>&#9888;</span>
          <span class="warning-box__title">Important: You're not done yet</span>
        </div>
        <p class="warning-box__content">
          After joining the network, you still need to set your name and change your Bluetooth PIN for security. Don't skip the next two steps.
        </p>
      </div>

      <!-- NAVIGATION -->
      <div class="nav-buttons">
        <a href="/setup/pair/" class="btn btn--secondary">&larr; Back</a>
        <a href="/setup/name/" class="btn btn--primary">Next: Set Your Name &rarr;</a>
      </div>

    </main>

    <!-- FOOTER -->
    <footer class="site-footer">
      <p class="footer__credit">
        Part of the <a href="https://hyphae.social">Hyphae Network</a> &middot; Built for Nashville
      </p>
    </footer>

  </div>

</body>
</html>
